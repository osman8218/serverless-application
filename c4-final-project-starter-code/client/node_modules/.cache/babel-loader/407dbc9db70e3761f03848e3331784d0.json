{"ast":null,"code":"import _defineProperty from \"C:/Users/123043/Documents/Code/udacity/udacity-project4/udacity-project4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"C:/Users/123043/Documents/Code/udacity/udacity-project4/udacity-project4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"C:/Users/123043/Documents/Code/udacity/udacity-project4/udacity-project4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"C:/Users/123043/Documents/Code/udacity/udacity-project4/udacity-project4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:/Users/123043/Documents/Code/udacity/udacity-project4/udacity-project4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/123043/Documents/Code/udacity/udacity-project4/udacity-project4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"C:/Users/123043/Documents/Code/udacity/udacity-project4/udacity-project4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:/Users/123043/Documents/Code/udacity/udacity-project4/udacity-project4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"C:\\\\Users\\\\123043\\\\Documents\\\\Code\\\\udacity\\\\udacity-project4\\\\udacity-project4\\\\client\\\\src\\\\components\\\\Todos.tsx\";\nimport dateFormat from 'dateformat';\nimport update from 'immutability-helper';\nimport * as React from 'react';\nimport { Button, Checkbox, Divider, Grid, Header, Icon, Input, Image, Loader } from 'semantic-ui-react';\nimport { createTodo, deleteTodo, getTodos, patchTodo } from '../api/todos-api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport var Todos = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(Todos, _React$PureComponent);\n\n  var _super = _createSuper(Todos);\n\n  function Todos() {\n    var _this;\n\n    _classCallCheck(this, Todos);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      todos: [],\n      newTodoName: '',\n      loadingTodos: true\n    };\n\n    _this.handleNameChange = function (event) {\n      _this.setState({\n        newTodoName: event.target.value\n      });\n    };\n\n    _this.onEditButtonClick = function (todoId) {\n      _this.props.history.push(\"/todos/\".concat(todoId, \"/edit\"));\n    };\n\n    _this.onTodoCreate = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        var dueDate, newTodo;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                dueDate = _this.calculateDueDate();\n                _context.next = 4;\n                return createTodo(_this.props.auth.getIdToken(), {\n                  name: _this.state.newTodoName,\n                  dueDate: dueDate\n                });\n\n              case 4:\n                newTodo = _context.sent;\n\n                _this.setState({\n                  todos: [].concat(_toConsumableArray(_this.state.todos), [newTodo]),\n                  newTodoName: ''\n                });\n\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                alert('Todo creation failed');\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 8]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.onTodoDelete = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(todoId) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return deleteTodo(_this.props.auth.getIdToken(), todoId);\n\n              case 3:\n                _this.setState({\n                  todos: _this.state.todos.filter(function (todo) {\n                    return todo.todoId !== todoId;\n                  })\n                });\n\n                _context2.next = 9;\n                break;\n\n              case 6:\n                _context2.prev = 6;\n                _context2.t0 = _context2[\"catch\"](0);\n                alert('Todo deletion failed');\n\n              case 9:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[0, 6]]);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.onTodoCheck = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(pos) {\n        var todo;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                todo = _this.state.todos[pos];\n                _context3.next = 4;\n                return patchTodo(_this.props.auth.getIdToken(), todo.todoId, {\n                  name: todo.name,\n                  dueDate: todo.dueDate,\n                  done: !todo.done\n                });\n\n              case 4:\n                _this.setState({\n                  todos: update(_this.state.todos, _defineProperty({}, pos, {\n                    done: {\n                      $set: !todo.done\n                    }\n                  }))\n                });\n\n                _context3.next = 10;\n                break;\n\n              case 7:\n                _context3.prev = 7;\n                _context3.t0 = _context3[\"catch\"](0);\n                alert('Todo update failed');\n\n              case 10:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[0, 7]]);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    return _this;\n  }\n\n  _createClass(Todos, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var todos;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return getTodos(this.props.auth.getIdToken());\n\n              case 3:\n                todos = _context4.sent;\n                this.setState({\n                  todos: todos,\n                  loadingTodos: false\n                });\n                _context4.next = 10;\n                break;\n\n              case 7:\n                _context4.prev = 7;\n                _context4.t0 = _context4[\"catch\"](0);\n                alert(\"Failed to fetch todos: \".concat(_context4.t0.message));\n\n              case 10:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 7]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Header, {\n          as: \"h1\",\n          children: \"TODOs\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 9\n        }, this), this.renderCreateTodoInput(), this.renderBulkOptions(), this.renderTodos()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 7\n      }, this);\n    }\n  }, {\n    key: \"renderCreateTodoInput\",\n    value: function renderCreateTodoInput() {\n      return /*#__PURE__*/_jsxDEV(Grid.Row, {\n        children: [/*#__PURE__*/_jsxDEV(Grid.Column, {\n          width: 16,\n          children: /*#__PURE__*/_jsxDEV(Input, {\n            action: {\n              color: 'teal',\n              labelPosition: 'left',\n              icon: 'add',\n              content: 'New task',\n              onClick: this.onTodoCreate\n            },\n            fluid: true,\n            actionPosition: \"left\",\n            placeholder: \"To change the world...\",\n            onChange: this.handleNameChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Grid.Column, {\n          width: 16,\n          children: /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 7\n      }, this);\n    }\n  }, {\n    key: \"renderBulkOptions\",\n    value: function renderBulkOptions() {\n      return /*#__PURE__*/_jsxDEV(Grid.Row, {\n        children: /*#__PURE__*/_jsxDEV(Grid.Column, {\n          width: 16,\n          children: [\"CAPSTONE Additions:\", /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 7\n      }, this);\n    }\n  }, {\n    key: \"renderTodos\",\n    value: function renderTodos() {\n      if (this.state.loadingTodos) {\n        return this.renderLoading();\n      }\n\n      return this.renderTodosList();\n    }\n  }, {\n    key: \"renderLoading\",\n    value: function renderLoading() {\n      return /*#__PURE__*/_jsxDEV(Grid.Row, {\n        children: /*#__PURE__*/_jsxDEV(Loader, {\n          indeterminate: true,\n          active: true,\n          inline: \"centered\",\n          children: \"Loading TODOs\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 7\n      }, this);\n    }\n  }, {\n    key: \"renderTodosList\",\n    value: function renderTodosList() {\n      var _this2 = this;\n\n      return /*#__PURE__*/_jsxDEV(Grid, {\n        padded: true,\n        children: this.state.todos.map(function (todo, pos) {\n          return /*#__PURE__*/_jsxDEV(Grid.Row, {\n            children: [/*#__PURE__*/_jsxDEV(Grid.Column, {\n              width: 1,\n              verticalAlign: \"middle\",\n              children: /*#__PURE__*/_jsxDEV(Checkbox, {\n                onChange: function onChange() {\n                  return _this2.onTodoCheck(pos);\n                },\n                checked: todo.done\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 17\n              }, _this2)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 15\n            }, _this2), /*#__PURE__*/_jsxDEV(Grid.Column, {\n              width: 10,\n              verticalAlign: \"middle\",\n              children: todo.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 15\n            }, _this2), /*#__PURE__*/_jsxDEV(Grid.Column, {\n              width: 3,\n              floated: \"right\",\n              children: todo.dueDate\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 15\n            }, _this2), /*#__PURE__*/_jsxDEV(Grid.Column, {\n              width: 1,\n              floated: \"right\",\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                icon: true,\n                color: \"blue\",\n                onClick: function onClick() {\n                  return _this2.onEditButtonClick(todo.todoId);\n                },\n                children: /*#__PURE__*/_jsxDEV(Icon, {\n                  name: \"pencil\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 194,\n                  columnNumber: 19\n                }, _this2)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 189,\n                columnNumber: 17\n              }, _this2)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 15\n            }, _this2), /*#__PURE__*/_jsxDEV(Grid.Column, {\n              width: 1,\n              floated: \"right\",\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                icon: true,\n                color: \"red\",\n                onClick: function onClick() {\n                  return _this2.onTodoDelete(todo.todoId);\n                },\n                children: /*#__PURE__*/_jsxDEV(Icon, {\n                  name: \"delete\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 203,\n                  columnNumber: 19\n                }, _this2)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 17\n              }, _this2)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 15\n            }, _this2), todo.attachmentUrl && /*#__PURE__*/_jsxDEV(Image, {\n              src: todo.attachmentUrl,\n              size: \"small\",\n              wrapped: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 17\n            }, _this2), /*#__PURE__*/_jsxDEV(Grid.Column, {\n              width: 16,\n              children: /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 210,\n                columnNumber: 17\n              }, _this2)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 15\n            }, _this2)]\n          }, todo.todoId, true, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 13\n          }, _this2);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 7\n      }, this);\n    }\n  }, {\n    key: \"calculateDueDate\",\n    value: function calculateDueDate() {\n      var date = new Date();\n      date.setDate(date.getDate() + 7);\n      return dateFormat(date, 'yyyy-mm-dd');\n    }\n  }]);\n\n  return Todos;\n}(React.PureComponent);","map":{"version":3,"sources":["C:/Users/123043/Documents/Code/udacity/udacity-project4/udacity-project4/client/src/components/Todos.tsx"],"names":["dateFormat","update","React","Button","Checkbox","Divider","Grid","Header","Icon","Input","Image","Loader","createTodo","deleteTodo","getTodos","patchTodo","Todos","state","todos","newTodoName","loadingTodos","handleNameChange","event","setState","target","value","onEditButtonClick","todoId","props","history","push","onTodoCreate","dueDate","calculateDueDate","auth","getIdToken","name","newTodo","alert","onTodoDelete","filter","todo","onTodoCheck","pos","done","$set","message","renderCreateTodoInput","renderBulkOptions","renderTodos","color","labelPosition","icon","content","onClick","renderLoading","renderTodosList","map","attachmentUrl","date","Date","setDate","getDate","PureComponent"],"mappings":"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","sourcesContent":["import dateFormat from 'dateformat'\r\nimport { History } from 'history'\r\nimport update from 'immutability-helper'\r\nimport * as React from 'react'\r\nimport {\r\n  Button,\r\n  Checkbox,\r\n  Divider,\r\n  Grid,\r\n  Header,\r\n  Icon,\r\n  Input,\r\n  Image,\r\n  Loader\r\n} from 'semantic-ui-react'\r\n\r\nimport { createTodo, deleteTodo, getTodos, patchTodo } from '../api/todos-api'\r\nimport Auth from '../auth/Auth'\r\nimport { Todo } from '../types/Todo'\r\n\r\ninterface TodosProps {\r\n  auth: Auth\r\n  history: History\r\n}\r\n\r\ninterface TodosState {\r\n  todos: Todo[]\r\n  newTodoName: string\r\n  loadingTodos: boolean\r\n}\r\n\r\nexport class Todos extends React.PureComponent<TodosProps, TodosState> {\r\n  state: TodosState = {\r\n    todos: [],\r\n    newTodoName: '',\r\n    loadingTodos: true\r\n  }\r\n\r\n  handleNameChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    this.setState({ newTodoName: event.target.value })\r\n  }\r\n\r\n  onEditButtonClick = (todoId: string) => {\r\n    this.props.history.push(`/todos/${todoId}/edit`)\r\n  }\r\n\r\n  onTodoCreate = async (event: React.ChangeEvent<HTMLButtonElement>) => {\r\n    try {\r\n      const dueDate = this.calculateDueDate()\r\n      const newTodo = await createTodo(this.props.auth.getIdToken(), {\r\n        name: this.state.newTodoName,\r\n        dueDate\r\n      })\r\n      this.setState({\r\n        todos: [...this.state.todos, newTodo],\r\n        newTodoName: ''\r\n      })\r\n    } catch {\r\n      alert('Todo creation failed')\r\n    }\r\n  }\r\n\r\n  onTodoDelete = async (todoId: string) => {\r\n    try {\r\n      await deleteTodo(this.props.auth.getIdToken(), todoId)\r\n      this.setState({\r\n        todos: this.state.todos.filter(todo => todo.todoId !== todoId)\r\n      })\r\n    } catch {\r\n      alert('Todo deletion failed')\r\n    }\r\n  }\r\n\r\n  onTodoCheck = async (pos: number) => {\r\n    try {\r\n      const todo = this.state.todos[pos]\r\n      await patchTodo(this.props.auth.getIdToken(), todo.todoId, {\r\n        name: todo.name,\r\n        dueDate: todo.dueDate,\r\n        done: !todo.done\r\n      })\r\n      this.setState({\r\n        todos: update(this.state.todos, {\r\n          [pos]: { done: { $set: !todo.done } }\r\n        })\r\n      })\r\n    } catch {\r\n      alert('Todo update failed')\r\n    }\r\n  }\r\n\r\n  async componentDidMount() {\r\n    try {\r\n      const todos = await getTodos(this.props.auth.getIdToken())\r\n      this.setState({\r\n        todos,\r\n        loadingTodos: false\r\n      })\r\n    } catch (e) {\r\n      alert(`Failed to fetch todos: ${e.message}`)\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Header as=\"h1\">TODOs</Header>\r\n\r\n        {this.renderCreateTodoInput()}\r\n        {this.renderBulkOptions()}\r\n        {this.renderTodos()}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  renderCreateTodoInput() {\r\n    return (\r\n      <Grid.Row>\r\n        <Grid.Column width={16}>\r\n          <Input\r\n            action={{\r\n              color: 'teal',\r\n              labelPosition: 'left',\r\n              icon: 'add',\r\n              content: 'New task',\r\n              onClick: this.onTodoCreate\r\n            }}\r\n            fluid\r\n            actionPosition=\"left\"\r\n            placeholder=\"To change the world...\"\r\n            onChange={this.handleNameChange}\r\n          />\r\n        </Grid.Column>\r\n        <Grid.Column width={16}>\r\n          <Divider />\r\n        </Grid.Column>\r\n      </Grid.Row>\r\n    )\r\n  }\r\n\r\n  renderBulkOptions() {\r\n    return (\r\n      <Grid.Row> \r\n        <Grid.Column width={16}>\r\n          CAPSTONE Additions:\r\n          <Divider />\r\n        </Grid.Column>\r\n      </Grid.Row>\r\n    )\r\n  }\r\n\r\n  renderTodos() {\r\n    if (this.state.loadingTodos) {\r\n      return this.renderLoading()\r\n    }\r\n\r\n    return this.renderTodosList()\r\n  }\r\n\r\n  renderLoading() {\r\n    return (\r\n      <Grid.Row>\r\n        <Loader indeterminate active inline=\"centered\">\r\n          Loading TODOs\r\n        </Loader>\r\n      </Grid.Row>\r\n    )\r\n  }\r\n\r\n  renderTodosList() {\r\n    return (\r\n      <Grid padded>\r\n        {this.state.todos.map((todo, pos) => {\r\n          return (\r\n            <Grid.Row key={todo.todoId}>\r\n              <Grid.Column width={1} verticalAlign=\"middle\">\r\n                <Checkbox\r\n                  onChange={() => this.onTodoCheck(pos)}\r\n                  checked={todo.done}\r\n                />\r\n              </Grid.Column>\r\n              <Grid.Column width={10} verticalAlign=\"middle\">\r\n                {todo.name}\r\n              </Grid.Column>\r\n              <Grid.Column width={3} floated=\"right\">\r\n                {todo.dueDate}\r\n              </Grid.Column>\r\n              <Grid.Column width={1} floated=\"right\">\r\n                <Button\r\n                  icon\r\n                  color=\"blue\"\r\n                  onClick={() => this.onEditButtonClick(todo.todoId)}\r\n                >\r\n                  <Icon name=\"pencil\" />\r\n                </Button>\r\n              </Grid.Column>\r\n              <Grid.Column width={1} floated=\"right\">\r\n                <Button\r\n                  icon\r\n                  color=\"red\"\r\n                  onClick={() => this.onTodoDelete(todo.todoId)}\r\n                >\r\n                  <Icon name=\"delete\" />\r\n                </Button>\r\n              </Grid.Column>\r\n              {todo.attachmentUrl && (\r\n                <Image src={todo.attachmentUrl} size=\"small\" wrapped />\r\n              )}\r\n              <Grid.Column width={16}>\r\n                <Divider />\r\n              </Grid.Column>\r\n            </Grid.Row>\r\n          )\r\n        })}\r\n      </Grid>\r\n    )\r\n  }\r\n\r\n  calculateDueDate(): string {\r\n    const date = new Date()\r\n    date.setDate(date.getDate() + 7)\r\n\r\n    return dateFormat(date, 'yyyy-mm-dd') as string\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}